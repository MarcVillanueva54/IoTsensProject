<html>
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<head>
    <title>IoTsens Project</title>
</head>
<body>
<p><a href="/scriptVariables"> Ves</a></p>

<p><a href="AnalyzeScripts.html">Go to script evaluation</a></p>
<h2>Variable & Script Definition</h2>
<form action="" id="submitForm" name="formVarScr" method="post">
    <div id="keyValueShow">
        <div class="keyInput">
            <input type="text" name="Clave[]" placeholder="key">
            &emsp;
            <input type="text" name="Valor[]" placeholder="value">
        </div>
        <br><br>
        <button class="addVariableButton">Add variable</button>
        <br><br>
        <textarea name="Script" placeholder="Place here your script" style="height: 200px; width: 350px;"></textarea> <br><br>
        <input type="submit" id="submitButton" class="submitScriptButton" value="Save vars & script">
    </div>
</form>

<script>
    $(document).ready(function (){
        $(".addVariableButton").click(function (e){
            e.preventDefault();
            $("#keyValueShow").prepend(`<div class="keyInput">
        <input type="text" name="Clave[]" placeholder="key">
        &emsp;
        <input type="text" name="Valor[]" placeholder="value">
      </div>`)
        });
    });

    //const data = Object.fromEntries(data.entries());

    //ajax petition
    $("#submitForm").submit(function (e){
        e.preventDefault();
        $.ajax({
            url: '/',
            method: 'post',
            data: $(this).serialize(),
            success: function (response){
                console.log(response);
            }
        });
    });
</script>

</body>
</html>